<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>DivePlan - Decompression Tables</title>
    <style>
        * { margin: 0; padding: 0; box-sizing: border-box; }
        body { font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif; background: linear-gradient(135deg, #f0f4f8 0%, #ffffff 50%, #f0f4f8 100%); color: #333; }
        .container { max-width: 1280px; margin: 0 auto; padding: 20px; }
        header { margin-bottom: 30px; }
        h1 { font-size: 32px; font-weight: 700; color: #1f2937; margin-bottom: 10px; }
        .subtitle { color: #6b7280; font-size: 16px; }
        
        .view { display: none; }
        .view.active { display: block; }
        
        /* Level 1 - Category cards */
        .level1-grid { display: grid; grid-template-columns: repeat(auto-fill, minmax(320px, 1fr)); gap: 20px; }
        .category-card {
            background: white;
            border: 1px solid #e5e7eb;
            border-radius: 8px;
            padding: 20px;
            cursor: pointer;
            transition: all 0.2s;
            box-shadow: 0 1px 3px rgba(0,0,0,0.1);
        }
        .category-card:hover { border-color: #3b82f6; box-shadow: 0 4px 12px rgba(0,0,0,0.15); }
        .category-tag {
            display: inline-block;
            padding: 4px 12px;
            border-radius: 4px;
            font-size: 12px;
            font-weight: 600;
            margin-bottom: 12px;
        }
        .category-card h3 { font-size: 18px; font-weight: 600; color: #1f2937; margin-bottom: 4px; }
        .category-card p { color: #6b7280; font-size: 14px; }
        .chevron { float: right; color: #9ca3af; }
        
        /* Level 2 & 3 - Back button & breadcrumbs */
        .back-btn { background: #3b82f6; color: white; border: none; padding: 10px 16px; border-radius: 4px; cursor: pointer; font-size: 14px; font-weight: 500; margin-bottom: 20px; }
        .back-btn:hover { background: #2563eb; }
        
        /* Level 2 - Table cards */
        .level2-grid { display: grid; grid-template-columns: repeat(auto-fill, minmax(300px, 1fr)); gap: 16px; }
        .table-card {
            background: white;
            border: 1px solid #e5e7eb;
            border-radius: 8px;
            padding: 16px;
            cursor: pointer;
            transition: all 0.2s;
        }
        .table-card:hover { border-color: #3b82f6; box-shadow: 0 4px 8px rgba(0,0,0,0.1); }
        .table-card h4 { font-size: 16px; font-weight: 600; color: #1f2937; margin-bottom: 8px; }
        .table-card p { color: #6b7280; font-size: 13px; }
        
        /* Level 3 - Depth selector */
        .depth-section { background: white; border-radius: 8px; padding: 20px; margin-bottom: 20px; }
        .depth-title { font-size: 20px; font-weight: 600; color: #1f2937; margin-bottom: 4px; }
        .depth-subtitle { color: #6b7280; font-size: 14px; margin-bottom: 16px; }
        .depths-grid { display: grid; grid-template-columns: repeat(auto-fill, minmax(80px, 1fr)); gap: 10px; }
        .depth-btn {
            padding: 12px;
            border: 2px solid #3b82f6;
            background: white;
            color: #3b82f6;
            border-radius: 6px;
            cursor: pointer;
            font-weight: bold;
            font-size: 14px;
            transition: all 0.2s;
        }
        .depth-btn:hover { background: #eff6ff; }
        .depth-btn.active { background: #3b82f6; color: white; }
        
        /* Table display */
        .table-section { background: white; border-radius: 8px; overflow: hidden; box-shadow: 0 1px 3px rgba(0,0,0,0.1); margin-bottom: 20px; }
        .table-header { background: linear-gradient(to bottom, #1d4ed8, #1e40af); color: white; padding: 20px; }
        .table-header h2 { font-size: 24px; font-weight: 600; margin-bottom: 4px; }
        .table-header p { font-size: 14px; opacity: 0.95; }
        
        .table-wrapper { overflow-x: auto; }
        table { width: 100%; border-collapse: collapse; font-size: 12px; }
        thead { background: linear-gradient(to bottom, #1d4ed8, #1e40af); color: white; position: sticky; top: 0; z-index: 10; }
        th {
            padding: 10px 6px;
            text-align: center;
            border: 1px solid #0d47a1;
            font-weight: 600;
            font-size: 11px;
            line-height: 1.2;
        }
        td {
            padding: 10px 6px;
            text-align: center;
            border: 1px solid #e5e7eb;
            font-size: 12px;
        }
        
        /* Row colors - exact from app */
        .row-white { background: white; }
        .row-white:hover { background: #eff6ff; }
        .row-green { background: #f0fdf4; }
        .row-green:hover { background: #eff6ff; }
        .row-orange-light { background: #fed7aa; }
        .row-orange-light:hover { background: #fef3c7; }
        .row-orange { background: white; }
        .row-orange:hover { background: #fef3c7; }
        .row-red { background: #fef2f2; }
        .row-red:hover { background: #fee2e2; }
        
        .marker-2 { border-bottom: 3px solid #1f2937 !important; }
        .marker-normal { border-bottom: 1px solid #e5e7eb; }
        
        footer { text-align: center; padding: 20px; color: #9ca3af; font-size: 12px; margin-top: 40px; border-top: 1px solid #e5e7eb; }
        
        /* Tag colors */
        .tag-blue { background: #dbeafe; color: #1e40af; }
        .tag-cyan { background: #cffafe; color: #0e7490; }
        .tag-orange { background: #fed7aa; color: #92400e; }
        .tag-yellow { background: #fef08a; color: #854d0e; }
        .tag-purple { background: #e9d5ff; color: #5b21b6; }
        .tag-green { background: #dcfce7; color: #166534; }
        .tag-indigo { background: #e0e7ff; color: #312e81; }
        .tag-red { background: #fee2e2; color: #991b1b; }
    </style>
</head>
<body>
    <div class="container">
        <header>
            <h1>Dive Tables Index</h1>
            <p class="subtitle">Browse all dive tables organized by type and category</p>
        </header>
        
        <!-- Level 1: Categories -->
        <div id="level1" class="view active">
            <div class="level1-grid" id="categoriesGrid"></div>
        </div>
        
        <!-- Level 2: Tables in Category -->
        <div id="level2" class="view">
            <button class="back-btn" onclick="app.goToLevel1()">← Back</button>
            <div class="level2-grid" id="tablesGrid"></div>
        </div>
        
        <!-- Level 3: Depths -->
        <div id="level3" class="view">
            <button class="back-btn" onclick="app.goToLevel2()">← Back</button>
            <div id="depthsContainer"></div>
        </div>
        
        <!-- Table Display -->
        <div id="tableDisplay" class="view">
            <button class="back-btn" onclick="app.goToLevel3()">← Back</button>
            <div id="tableContainer"></div>
        </div>
        
        <footer>DivePlan Tables Widget v1.0 | All CSV data embedded | Offline ready</footer>
    </div>

    <script>
        const app = {
            tablesData: [
                {
                    name: "No-Stop Limits for Air Diving",
                    tag: "No Stops Air",
                    tagClass: "tag-blue",
                    children: [
                        { name: "Air diving, no-stop limits in minutes", code: "ND15" },
                        { name: "No-Stop Limits for Air Diving Extended", code: "LND15" }
                    ]
                },
                {
                    name: "Standard Air Tables",
                    tag: "Standard Air",
                    tagClass: "tag-cyan",
                    children: [
                        { name: "Repetitive Interval 12 Hours", code: "SIL15", depths: [12,15,18,21,24,27,30,33,36,39,42,45,48,51] },
                        { name: "Repetitive Interval 2 Hours", code: "H2SIL15", depths: [12,15,18,21,24,27,30,33,36,39,42,45,48,51] },
                        { name: "Repetitive Interval 4 Hours", code: "H4SIL15", depths: [12,15,18,21,24,27,30,33,36,39,42,45,48,51] }
                    ]
                },
                {
                    name: "Surface/OX Tables",
                    tag: "SurD O2",
                    tagClass: "tag-orange",
                    children: [
                        { name: "Repetitive Interval 12 Hours", code: "SOX15", depths: [12,15,18,21,24,27,30,33,36,39,42,45,48,51] },
                        { name: "Repetitive Interval 4 Hours", code: "HSOX15", depths: [12,15,18,21,24,27,30,33,36,39,42,45,48,51] }
                    ]
                },
                {
                    name: "Backup Air Tables",
                    tag: "Backup Air",
                    tagClass: "tag-yellow",
                    children: [
                        { name: "Backup Air – Repetitive Interval 12 Hours", code: "SAB15", depths: [12,15,18,21,24,27,30,33,36,39,42,45,48,51] },
                        { name: "Backup Air – Repetitive Interval 4 Hours", code: "HSAB15", depths: [12,15,18,21,24,27,30,33,36,39,42,45,48,51] }
                    ]
                },
                {
                    name: "Nitrox Decompression Tables",
                    tag: "Nitrox",
                    tagClass: "tag-green",
                    children: [
                        { name: "Nitrox 40/60 Repetitive Interval 12 Hours", code: "NIA15", depths: [18,21,24,27] },
                        { name: "Nitrox 40/60 Repetitive Interval 2 Hours", code: "H2NIA15", depths: [18,21,24,27] },
                        { name: "Nitrox 40/60 Repetitive Interval 4 Hours", code: "H4NIA15", depths: [18,21,24,27] },
                        { name: "Nitrox 35/65 Repetitive Interval 12 Hours", code: "NIB15", depths: [18,21,24,27,30,33] },
                        { name: "Nitrox 35/65 Repetitive Interval 2 Hours", code: "H2NIB15", depths: [18,21,24,27,30,33] },
                        { name: "Nitrox 35/65 Repetitive Interval 4 Hours", code: "H4NIB15", depths: [18,21,24,27,30,33] }
                    ]
                },
                {
                    name: "Wet or Dry Bell Air/Oxygen Tables",
                    tag: "Wet/Dry Bell",
                    tagClass: "tag-indigo",
                    children: [
                        { name: "Bell Air/Oxygen Decompression", code: "BOX15", depths: [12,15,18,21,24,27,30,33,36,39,42,45,48,51] }
                    ]
                }
            ],
            
            headers: {
                'SIL15': { title: 'SIL15 - Standard Air, Repetitive Interval 12 Hours', cols: ['Dive Time (min)', 'Till 1st Stop', '24', '21', '18', '15', '12', '9', '6', '3', 'Tot. Deco Time (min)', 'Tot. OTU', 'Tot. ESOT'] },
                'H2SIL15': { title: 'H2SIL15 - Standard Air, Repetitive Interval 2 Hours', cols: ['Dive Time (min)', 'Till 1st Stop', '24', '21', '18', '15', '12', '9', '6', '3', 'Tot. Deco Time (min)', 'Tot. OTU', 'Tot. ESOT'] },
                'H4SIL15': { title: 'H4SIL15 - Standard Air, Repetitive Interval 4 Hours', cols: ['Dive Time (min)', 'Till 1st Stop', '24', '21', '18', '15', '12', '9', '6', '3', 'Tot. Deco Time (min)', 'Tot. OTU', 'Tot. ESOT'] },
                'SOX15': { title: 'SOX15 - Surface Decompression with Oxygen, Repetitive Interval 12 Hours', cols: ['Dive Time (min)', 'Till 1st Stop', 'In Water Stops', '21 air', '18 air', '15 air', '12 air', '9 air', '12 ox', 'Stops in Deco Chamber', '9 air', '9 ox', '6 air', '6 ox', '3 air', '3 ox', 'Tot. Deco Time (min)', 'Tot. OTU', 'Tot. ESOT'] },
                'HSOX15': { title: 'HSOX15 - Surface Decompression with Oxygen, Repetitive Interval 4 Hours', cols: ['Dive Time (min)', 'Till 1st Stop', 'In Water Stops', '21 air', '18 air', '15 air', '12 air', '9 air', '12 ox', 'Stops in Deco Chamber', '9 air', '9 ox', '6 air', '6 ox', '3 air', '3 ox', 'Tot. Deco Time (min)', 'Tot. OTU', 'Tot. ESOT'] },
                'SAB15': { title: 'SAB15 - Backup Air, Repetitive Interval 12 Hours', cols: ['Dive Time (min)', 'Till 1st Stop', 'In Water Stops', '21', '18', '15', '12', '9', '18', 'Stops in Deco Chamber', '15', '12', '9', '6', '3', 'Tot. Deco Time (min)', 'Tot. OTU', 'Tot. ESOT'] },
                'HSAB15': { title: 'HSAB15 - Backup Air, Repetitive Interval 4 Hours', cols: ['Dive Time (min)', 'Till 1st Stop', 'In Water Stops', '21', '18', '15', '12', '9', '18', 'Stops in Deco Chamber', '15', '12', '9', '6', '3', 'Tot. Deco Time (min)', 'Tot. OTU', 'Tot. ESOT'] },
                'NIA15': { title: 'NIA15 - Nitrox 40/60, Repetitive Interval 12 Hours', cols: ['Dive Time (min)', 'Till 1st Stop', '24', '21', '18', '15', '12', '9', '6', '3', 'Tot. Deco Time (min)', 'Tot. OTU', 'Tot. ESOT'] },
                'H2NIA15': { title: 'H2NIA15 - Nitrox 40/60, Repetitive Interval 2 Hours', cols: ['Dive Time (min)', 'Till 1st Stop', '24', '21', '18', '15', '12', '9', '6', '3', 'Tot. Deco Time (min)', 'Tot. OTU', 'Tot. ESOT'] },
                'H4NIA15': { title: 'H4NIA15 - Nitrox 40/60, Repetitive Interval 4 Hours', cols: ['Dive Time (min)', 'Till 1st Stop', '24', '21', '18', '15', '12', '9', '6', '3', 'Tot. Deco Time (min)', 'Tot. OTU', 'Tot. ESOT'] },
                'NIB15': { title: 'NIB15 - Nitrox 35/65, Repetitive Interval 12 Hours', cols: ['Dive Time (min)', 'Till 1st Stop', '24', '21', '18', '15', '12', '9', '6', '3', 'Tot. Deco Time (min)', 'Tot. OTU', 'Tot. ESOT'] },
                'H2NIB15': { title: 'H2NIB15 - Nitrox 35/65, Repetitive Interval 2 Hours', cols: ['Dive Time (min)', 'Till 1st Stop', '24', '21', '18', '15', '12', '9', '6', '3', 'Tot. Deco Time (min)', 'Tot. OTU', 'Tot. ESOT'] },
                'H4NIB15': { title: 'H4NIB15 - Nitrox 35/65, Repetitive Interval 4 Hours', cols: ['Dive Time (min)', 'Till 1st Stop', '24', '21', '18', '15', '12', '9', '6', '3', 'Tot. Deco Time (min)', 'Tot. OTU', 'Tot. ESOT'] },
                'BOX15': { title: 'BOX15 - Wet or Dry Bell Air/Oxygen Tables, Repetitive Interval 12 Hours', cols: ['Dive Time (min)', 'Till 1st Stop', '24 air', '21 air', '18 air', '15 air', '12 air', '9 ox', '6 air', '6 ox', '6 air', '6 ox', '6 air', '6 ox', 'Tot. Deco Time (min)', 'Tot. OTU', 'Tot. ESOT'] },
                'ND15': { title: 'ND15 - Air Diving, No-Stop Limits in Minutes', cols: ['Maximum Diving Depth (metres)', 'Repeat Interval 8 Hours (minutes)', 'Repeat Interval 2 Hours (minutes)'] },
                'LND15': { title: 'LND15 - Air Diving, Long No-Stop Limits in Minutes', cols: ['Maximum Diving Depth (metres)', 'Normal No-Stop Limits ND15 (minutes)', 'Long No-Stop Limits LND15 (minutes)'] }
            },
            
            csvData: {
                'SIL15': `240,12,120,0.9,,,,,,,,1,2.2,,21
240,12,130,0.9,,,,,,,,3,4.2,,23
240,12,140,0.9,,,,,,,,5,6.2,,24
240,12,150,0.9,,,,,,,,6,7.2,,26
240,12,160,0.9,,,,,,,,7,8.2,,28
240,12,170,0.9,,,,,,,,9,10.2,,30
240,12,180,0.9,,,,,,,,13,14.2,,32,3
180,15,70,1.2,,,,,,,,2,3.5,6,16
180,15,80,1.2,,,,,,,,7,8.5,7,19
180,15,90,1.2,,,,,,,,11,12.5,7,21
180,15,100,1.2,,,,,,,,14,15.5,8,24
180,15,110,1.2,,,,,,,,17,18.5,9,26
180,15,120,1.2,,,,,,,,19,20.5,10,29
180,15,130,1.2,,,,,,,,24,25.5,11,31
180,15,140,1.2,,,,,,,,31,32.5,12,34,2
180,15,150,1.2,,,,,,,,36,37.5,12,36
180,15,160,1.2,,,,,,,,41,42.5,13,39
180,15,170,1.2,,,,,,,,45,46.5,14,42
180,15,180,1.2,,,,,,,,49,50.5,15,44,3
120,18,40,1.5,,,,,,,,2,3.8,9,12
120,18,50,1.5,,,,,,,,5,6.8,12,16
120,18,60,1.5,,,,,,,,10,11.8,14,19
120,18,70,1.5,,,,,,,,16,17.8,16,22
120,18,80,1.5,,,,,,,,21,22.8,19,25
120,18,90,1.5,,,,,,,,25,26.8,21,28
120,18,100,1.2,,,,,,,2,28,31.8,24,32,2
120,18,110,1.2,,,,,,,5,35,41.8,26,35
120,18,120,1.2,,,,,,,8,41,50.8,28,39
120,18,130,1.2,,,,,,,10,47,58.8,31,42
120,18,140,1.2,,,,,,,12,51,64.8,33,45
120,18,150,1.2,,,,,,,13,55,69.8,35,49,3`,
                'H2NIA15': `Nitrox 40%O2 - 60%N2,H2NIA15,40,240,2,12,1.12,18,90,1.5,,,,,,,,1,2.8,109,119,0
Nitrox 40%O2 - 60%N2,H2NIA15,40,240,2,12,1.12,18,100,1.5,,,,,,,,3,4.8,121,133,1
Nitrox 40%O2 - 60%N2,H2NIA15,40,240,2,12,1.12,18,110,1.5,,,,,,,,7,8.8,133,147,0
Nitrox 40%O2 - 60%N2,H2NIA15,40,240,2,12,1.12,18,120,1.5,,,,,,,,11,12.8,145,160,1
Nitrox 40%O2 - 60%N2,H2NIA15,40,240,2,12,1.12,18,130,1.5,,,,,,,,15,16.8,158,174,0
Nitrox 40%O2 - 60%N2,H2NIA15,40,240,2,12,1.12,18,140,1.5,,,,,,,,19,20.8,170,188,1
Nitrox 40%O2 - 60%N2,H2NIA15,40,240,2,12,1.12,18,150,1.5,,,,,,,,23,24.8,182,202,3
Nitrox 40%O2 - 60%N2,H2NIA15,40,180,2,14.4,1.24,21,60,1.8,,,,,,,,1,3.1,85,102,0
Nitrox 40%O2 - 60%N2,H2NIA15,40,180,2,14.4,1.24,21,70,1.8,,,,,,,,5,7.1,99,119,1
Nitrox 40%O2 - 60%N2,H2NIA15,40,180,2,14.4,1.24,21,80,1.8,,,,,,,,10,12.1,113,136,0
Nitrox 40%O2 - 60%N2,H2NIA15,40,180,2,14.4,1.24,21,90,1.8,,,,,,,,16,18.1,127,154,1
Nitrox 40%O2 - 60%N2,H2NIA15,40,180,2,14.4,1.24,21,100,1.8,,,,,,,,24,26.1,142,172,0
Nitrox 40%O2 - 60%N2,H2NIA15,40,180,2,14.4,1.24,21,110,1.8,,,,,,,,32,34.1,156,190,1
Nitrox 40%O2 - 60%N2,H2NIA15,40,180,2,14.4,1.24,21,120,1.8,,,,,,,,39,41.1,170,208,0
Nitrox 40%O2 - 60%N2,H2NIA15,40,180,2,14.4,1.24,21,130,1.8,,,,,,,,47,49.1,185,227,1
Nitrox 40%O2 - 60%N2,H2NIA15,40,180,2,14.4,1.24,21,140,1.8,,,,,,,,54,56.1,199,244,0
Nitrox 40%O2 - 60%N2,H2NIA15,40,180,2,14.4,1.24,21,150,1.8,,,,,,,,60,62.1,213,262,3
Nitrox 40%O2 - 60%N2,H2NIA15,40,120,2,16.7,1.36,24,40,2.1,,,,,,,,1,3.4,65,86,0
Nitrox 40%O2 - 60%N2,H2NIA15,40,120,2,16.7,1.36,24,50,2.1,,,,,,,,4,6.4,81,107,1
Nitrox 40%O2 - 60%N2,H2NIA15,40,120,2,16.7,1.36,24,60,2.1,,,,,,,,9,11.4,97,128,0
Nitrox 40%O2 - 60%N2,H2NIA15,40,120,2,16.7,1.36,24,70,2.1,,,,,,,,19,21.4,113,150,1
Nitrox 40%O2 - 60%N2,H2NIA15,40,120,2,16.7,1.36,24,80,2.1,,,,,,,,30,32.4,130,173,0
Nitrox 40%O2 - 60%N2,H2NIA15,40,120,2,16.7,1.36,24,90,2.1,,,,,,,,40,42.4,146,195,1
Nitrox 40%O2 - 60%N2,H2NIA15,40,120,2,16.7,1.36,24,100,1.8,,,,,,,1,50,53.4,163,218,0
Nitrox 40%O2 - 60%N2,H2NIA15,40,120,2,16.7,1.36,24,110,1.8,,,,,,,3,58,63.4,180,240,1
Nitrox 40%O2 - 60%N2,H2NIA15,40,120,2,16.7,1.36,24,120,1.8,,,,,,,5,66,73.4,197,263,3`
            },
            
            currentLevel: 'level1',
            selectedLevel1: null,
            selectedLevel2: null,
            
            init() {
                this.renderLevel1();
            },
            
            renderLevel1() {
                const grid = document.getElementById('categoriesGrid');
                grid.innerHTML = '';
                this.tablesData.forEach((cat, idx) => {
                    const div = document.createElement('div');
                    div.className = 'category-card';
                    div.onclick = () => this.goToLevel2(idx);
                    div.innerHTML = `
                        <div class="category-tag ${cat.tagClass}">${cat.tag}</div>
                        <h3>${cat.name}</h3>
                        <p>${cat.children.length} tables</p>
                        <span class="chevron">→</span>
                    `;
                    grid.appendChild(div);
                });
            },
            
            goToLevel2(level1Idx) {
                this.selectedLevel1 = level1Idx;
                this.selectedLevel2 = null;
                this.currentLevel = 'level2';
                this.updateView();
                this.renderLevel2();
            },
            
            renderLevel2() {
                const grid = document.getElementById('tablesGrid');
                grid.innerHTML = '';
                const cat = this.tablesData[this.selectedLevel1];
                cat.children.forEach((table, idx) => {
                    const div = document.createElement('div');
                    div.className = 'table-card';
                    div.onclick = () => this.goToLevel3(idx);
                    div.innerHTML = `<h4>${table.name}</h4><p>${table.depths ? table.depths.length + ' depths' : 'Reference table'}</p>`;
                    grid.appendChild(div);
                });
            },
            
            goToLevel3(level2Idx) {
                this.selectedLevel2 = level2Idx;
                const table = this.tablesData[this.selectedLevel1].children[this.selectedLevel2];
                if (!table.depths) {
                    this.navigateToTable(table.code, null);
                    return;
                }
                this.currentLevel = 'level3';
                this.updateView();
                this.renderLevel3();
            },
            
            renderLevel3() {
                const table = this.tablesData[this.selectedLevel1].children[this.selectedLevel2];
                const container = document.getElementById('depthsContainer');
                const depthsHtml = table.depths.map(d => `<button class="depth-btn" onclick="app.selectDepth(${d})">${d}m</button>`).join('');
                container.innerHTML = `<div class="depth-section"><div class="depth-title">${table.name}</div><div class="depth-subtitle">${table.code} | ${table.depths.length} depths available</div><div class="depths-grid">${depthsHtml}</div></div>`;
            },
            
            selectDepth(depth) {
                const table = this.tablesData[this.selectedLevel1].children[this.selectedLevel2];
                this.navigateToTable(table.code, depth);
            },
            
            navigateToTable(code, depth) {
                this.currentLevel = 'tableDisplay';
                this.updateView();
                this.renderTable(code, depth);
            },
            
            updateView() {
                document.querySelectorAll('.view').forEach(v => v.classList.remove('active'));
                document.getElementById(this.currentLevel === 'tableDisplay' ? 'tableDisplay' : this.currentLevel).classList.add('active');
            },
            
            renderTable(code, depth) {
                const header = this.headers[code];
                const csvData = this.csvData[code];
                if (!header || !csvData) {
                    document.getElementById('tableContainer').innerHTML = '<p>Table data not available</p>';
                    return;
                }
                
                const rows = csvData.split('\n').filter(l => l.trim());
                let tableRows = [];
                rows.forEach(line => {
                    const cells = line.split(',');
                    const depthCol = parseInt(cells[1]);
                    if (!depth || depthCol === depth) {
                        const isRef = code === 'ND15' || code === 'LND15';
                        const marker = cells[cells.length - 1];
                        tableRows.push({ cells, marker: parseInt(marker) || 0, isRef });
                    }
                });
                
                let html = `<div class="table-section"><div class="table-header"><h2>${header.title}${depth ? ` - ${depth}m` : ''}</h2></div><div class="table-wrapper"><table>`;
                html += '<thead><tr>' + header.cols.map(c => `<th>${c}</th>`).join('') + '</tr></thead><tbody>';
                
                tableRows.forEach((row, idx) => {
                    const isLast = idx === tableRows.length - 1;
                    let rowClass = 'row-white marker-normal';
                    if (row.isRef) {
                        rowClass = idx % 2 === 0 ? 'row-orange-light marker-normal' : 'row-orange marker-normal';
                    } else {
                        if (isLast) rowClass = 'row-red marker-normal';
                        else rowClass = idx % 2 === 0 ? 'row-white marker-normal' : 'row-green marker-normal';
                    }
                    if (row.marker === 2) rowClass = rowClass.replace('marker-normal', 'marker-2');
                    
                    html += `<tr class="${rowClass}">`;
                    row.cells.forEach((cell, cidx) => {
                        if (cidx >= header.cols.length) return;
                        const val = cell.trim() === '' ? '—' : cell.trim();
                        html += `<td>${val}</td>`;
                    });
                    html += '</tr>';
                });
                
                html += '</tbody></table></div></div>';
                document.getElementById('tableContainer').innerHTML = html;
            },
            
            goToLevel1() { this.currentLevel = 'level1'; this.updateView(); },
            goToLevel2() { this.currentLevel = 'level2'; this.updateView(); },
            goToLevel3() { this.currentLevel = 'level3'; this.updateView(); }
        };
        
        window.addEventListener('load', () => app.init());
    </script>
</body>
</html>
